<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIRide - Movilidad Inteligente Powered by AI</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <!-- Navigation -->
    <nav class="nav-bar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-car"></i>
                <span>AIRide</span>
            </div>
            <div class="nav-controls">
                <select id="citySelector" class="city-selector">
                    <option value="">Select City</option>
                </select>
                <div class="user-menu">
                    <button class="btn btn--secondary" id="authBtn">Login</button>
                    <div class="user-avatar hidden" id="userAvatar">
                        <i class="fas fa-user"></i>
                        <div class="dropdown-menu" id="userDropdown">
                            <a href="#" onclick="showView('wallet')">Wallet</a>
                            <a href="#" onclick="showView('profile')">Profile</a>
                            <a href="#" onclick="showView('settings')">Settings</a>
                            <a href="#" onclick="logout()">Logout</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>Login to AIRide</h2>
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('rider')">Rider</button>
                <button class="tab-btn" onclick="switchTab('driver')">Driver</button>
                <button class="tab-btn" onclick="switchTab('admin')">Admin</button>
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn--primary btn--full-width">Login</button>
            </form>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Home/Dashboard View -->
        <div class="view" id="homeView">
            <div class="container">
                <!-- Hero Section -->
                <div class="hero-section">
                    <div class="ai-banner">
                        <div class="ai-banner-content">
                            <h1>Movilidad Inteligente Powered by AI</h1>
                            <div class="ai-features">
                                <span class="ai-pill">Rutas Inteligentes</span>
                                <span class="ai-pill">Precios Dinámicos</span>
                                <span class="ai-pill">Emparejamiento IA</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value">98.5%</div>
                            <div class="stat-label">Safety Rating</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">45</div>
                            <div class="stat-label">Active Cities</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">12.5M</div>
                            <div class="stat-label">Users</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">85M</div>
                            <div class="stat-label">Trips</div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <button class="btn btn--primary btn--lg" onclick="showView('services')">Request Ride Now</button>
                        <button class="btn btn--outline btn--lg" onclick="showView('driverDashboard')">Join as Driver</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Map View -->
        <div class="view hidden" id="mapView">
            <!-- Location Permission Modal -->
            <div class="modal" id="locationPermissionModal">
                <div class="modal-content">
                    <h2>Enable Location Services</h2>
                    <div class="permission-content">
                        <div class="permission-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <p>AIRide needs your location to find nearby drivers, calculate accurate ETAs, and provide the best routes. Your location is only used while using the app.</p>
                        <div class="permission-buttons">
                            <button class="btn btn--outline" onclick="denyLocation()">Deny</button>
                            <button class="btn btn--primary" onclick="requestLocation()">Allow Location</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Manual Address Modal -->
            <div class="modal" id="manualAddressModal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal('manualAddressModal')">&times;</span>
                    <h2>Enter Your Location</h2>
                    <div class="form-group">
                        <label class="form-label">Enter your address</label>
                        <input type="text" class="form-control" id="manualAddress" placeholder="Av. Paseo de la Reforma 222, Juárez, CDMX">
                    </div>
                    <button class="btn btn--primary btn--full-width" onclick="useManualAddress()">Use This Location</button>
                </div>
            </div>

            <!-- Map Container -->
            <div class="map-container" id="mapContainer">
                <div id="leafletMap"></div>
                
                <!-- Map Controls -->
                <div class="map-controls">
                    <button class="map-control-btn" onclick="showView('services')" title="Back">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="map-control-btn" onclick="recenterMap()" title="Recenter">
                        <i class="fas fa-crosshairs"></i>
                    </button>
                    <button class="map-control-btn" onclick="toggleMapLayer()" title="Toggle Layer">
                        <i class="fas fa-layer-group"></i>
                    </button>
                </div>

                <!-- Search Bar -->
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <i class="fas fa-search"></i>
                        <input type="text" id="destinationSearch" placeholder="Where to?" autocomplete="off">
                    </div>
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>

                <!-- Location Cards -->
                <div class="location-cards">
                    <div class="location-card pickup-card">
                        <div class="location-icon pickup-icon">
                            <i class="fas fa-circle"></i>
                        </div>
                        <div class="location-info">
                            <div class="location-label">Pickup Location</div>
                            <div class="location-address" id="pickupAddress">Detecting your location...</div>
                        </div>
                        <button class="btn btn--sm btn--outline" onclick="editPickupLocation()">Edit</button>
                    </div>
                    
                    <div class="location-card dropoff-card hidden" id="dropoffCard">
                        <div class="location-icon dropoff-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="location-info">
                            <div class="location-label">Dropoff Location</div>
                            <div class="location-address" id="dropoffAddress">Select destination</div>
                        </div>
                        <button class="btn btn--sm btn--outline" onclick="editDropoffLocation()">Edit</button>
                    </div>
                </div>

                <!-- Route Selection Panel -->
                <div class="route-panel hidden" id="routePanel">
                    <h3>Choose Your Route</h3>
                    <div class="route-options" id="routeOptions"></div>
                    <button class="btn btn--primary btn--full-width" id="requestRideBtn" onclick="requestRide()" disabled>Request Ride - Select Route First</button>
                </div>

                <!-- Driver Info Card -->
                <div class="driver-card hidden" id="driverCard">
                    <div class="driver-header">
                        <div class="driver-avatar">
                            <img id="driverPhoto" src="" alt="Driver">
                        </div>
                        <div class="driver-info">
                            <div class="driver-name" id="driverName">Carlos M.</div>
                            <div class="driver-rating" id="driverRating">
                                <i class="fas fa-star"></i> 4.8
                            </div>
                            <div class="driver-vehicle" id="driverVehicle">Toyota Corolla • White • ABC-1234</div>
                        </div>
                        <div class="driver-actions">
                            <button class="btn btn--sm btn--outline" onclick="callDriver()">
                                <i class="fas fa-phone"></i>
                            </button>
                            <button class="btn btn--sm btn--outline" onclick="messageDriver()">
                                <i class="fas fa-message"></i>
                            </button>
                        </div>
                    </div>
                    <div class="tracking-info">
                        <div class="eta-display">
                            <span class="eta-label">Driver arriving in</span>
                            <span class="eta-time" id="etaTime">5 min 30 sec</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <button class="btn btn--secondary btn--full-width" onclick="shareTrip()">
                            <i class="fas fa-share"></i> Share Trip
                        </button>
                    </div>
                </div>

                <!-- During Ride Panel -->
                <div class="ride-panel hidden" id="ridePanel">
                    <div class="ride-status">
                        <h3>En Route to Destination</h3>
                        <div class="ride-stats">
                            <div class="ride-stat">
                                <span class="stat-label">Current Fare</span>
                                <span class="stat-value" id="currentFare">$45.50</span>
                            </div>
                            <div class="ride-stat">
                                <span class="stat-label">Distance</span>
                                <span class="stat-value" id="distanceTraveled">8.2 km</span>
                            </div>
                            <div class="ride-stat">
                                <span class="stat-label">ETA</span>
                                <span class="stat-value" id="destinationETA">12 min</span>
                            </div>
                        </div>
                    </div>
                    <div class="safety-controls">
                        <button class="btn btn--outline" onclick="shareTrip()">
                            <i class="fas fa-share"></i> Share Trip
                        </button>
                        <div class="trip-recording">
                            <i class="fas fa-record-vinyl recording-icon"></i>
                            <span>Trip being recorded for safety</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Errands & Tasks View -->
        <div class="view hidden" id="errandsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('services')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Plan Your Errands</h2>
                    <div class="errands-badge">NEW</div>
                </div>
                
                <div class="errands-subtitle">
                    Add multiple stops and we'll optimize your route
                </div>

                <div class="stops-container" id="stopsContainer">
                    <!-- Stops will be added dynamically -->
                </div>

                <button class="btn btn--primary add-stop-btn" onclick="addStop()">
                    <i class="fas fa-plus"></i> Add Stop (Maximum 5)
                </button>

                <div class="route-optimization">
                    <button class="btn btn--outline" onclick="optimizeRoute()">
                        <i class="fas fa-route"></i> Optimize Route
                    </button>
                    <div class="optimization-info">AI will reorder stops for efficiency</div>
                </div>

                <div class="errands-map-preview" id="errandsMapPreview">
                    <div class="map-preview-header">
                        <h4>Route Preview</h4>
                        <button class="btn btn--sm btn--outline" onclick="viewFullMap()">View Full Map</button>
                    </div>
                    <div class="mini-map" id="miniMap">Map preview with numbered pins</div>
                </div>

                <div class="pricing-calculator" id="pricingCalculator">
                    <h4>Price Breakdown</h4>
                    <div class="price-breakdown" id="priceBreakdown">
                        <div class="price-line">Base Fee: <span id="baseFeeAmount">$45.00 MXN</span></div>
                        <div class="price-line" id="additionalStopsLine" style="display:none;">Additional Stops (<span id="additionalStopsCount">0</span>): <span id="additionalStopsAmount">$0.00 MXN</span></div>
                        <div class="price-line" id="distanceLine" style="display:none;">Distance (<span id="totalDistance">0</span> km × <span id="perKmRate">$13</span>/km): <span id="distanceAmount">$0.00 MXN</span></div>
                        <div class="price-line" id="waitTimeLine" style="display:none;">Wait Time (<span id="totalWaitTime">0</span> min × $5 per 5 min): <span id="waitTimeAmount">$0.00 MXN</span></div>
                        <div class="price-line" id="shoppingFeeLine" style="display:none;">Shopping Service Fee (10% of $<span id="shoppingAmount">0</span>): <span id="shoppingFeeAmount">$0.00 MXN</span></div>
                        <hr class="price-divider">
                        <div class="price-line">Subtotal: <span id="subtotalAmount">$45.00 MXN</span></div>
                        <div class="price-line">Service Fee (5%): <span id="serviceFeeAmount">$2.25 MXN</span></div>
                        <hr class="price-divider-total">
                        <div class="price-total">TOTAL: <span id="totalAmount">$47.25 MXN</span></div>
                    </div>
                </div>

                <button class="btn btn--primary btn--lg btn--full-width request-errands-btn" id="requestErrandsBtn" onclick="requestErrands()" disabled>
                    Request Errands - Select stops first
                </button>
            </div>
        </div>

        <!-- Admin Errands Management -->
        <div class="view hidden" id="adminErrandsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Errands &amp; Tasks Module</h2>
                    <div class="live-counter">
                        <span class="counter-value" id="activeErrandsCount">15</span>
                        <span class="counter-label">active errands now</span>
                    </div>
                </div>

                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="switchAdminTab('dashboard')">Dashboard</button>
                    <button class="tab-btn" onclick="switchAdminTab('pricing')">Pricing Settings</button>
                    <button class="tab-btn" onclick="switchAdminTab('analytics')">Analytics</button>
                </div>

                <!-- Errands Dashboard Tab -->
                <div class="admin-tab-content active" id="dashboardTab">
                    <div class="errands-stats">
                        <div class="stat-card">
                            <div class="stat-value">$47,329</div>
                            <div class="stat-label">Today's Revenue</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">2.8</div>
                            <div class="stat-label">Avg Stops per Errand</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">94%</div>
                            <div class="stat-label">Completion Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">4.7★</div>
                            <div class="stat-label">Customer Rating</div>
                        </div>
                    </div>

                    <div class="errands-table">
                        <h3>Active Errands</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Customer</th>
                                    <th>Driver</th>
                                    <th>Stops</th>
                                    <th>Status</th>
                                    <th>Total</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="errandsTableBody">
                                <tr>
                                    <td>ERR-001</td>
                                    <td>María González</td>
                                    <td>Carlos M.</td>
                                    <td>3 stops</td>
                                    <td><span class="status-badge active">In Progress</span></td>
                                    <td>$296.63 MXN</td>
                                    <td>
                                        <button class="btn btn--sm btn--outline">View</button>
                                        <button class="btn btn--sm btn--secondary">Track</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pricing Settings Tab -->
                <div class="admin-tab-content" id="pricingTab">
                    <div class="pricing-section">
                        <h3>Base Pricing Structure</h3>
                        <div class="pricing-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Base Fee (first stop)</label>
                                    <div class="input-with-currency">
                                        <span class="currency-symbol">$</span>
                                        <input type="number" class="form-control" id="baseFee" value="45.00" step="0.01">
                                        <span class="currency-code">MXN</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Additional Stop Fee</label>
                                    <div class="input-with-currency">
                                        <span class="currency-symbol">$</span>
                                        <input type="number" class="form-control" id="additionalStopFee" value="15.00" step="0.01">
                                        <span class="currency-code">MXN per stop</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Per Kilometer Rate</label>
                                    <div class="input-with-currency highlight-field">
                                        <span class="currency-symbol">$</span>
                                        <input type="number" class="form-control" id="perKmRate" value="13.00" step="0.01">
                                        <span class="currency-code">MXN/km</span>
                                    </div>
                                    <small class="form-help">Charge per kilometer of total route distance</small>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Maximum Stops</label>
                                    <input type="number" class="form-control" id="maxStops" value="5" min="1" max="10">
                                </div>
                            </div>

                            <h4>Time Pricing</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Wait Time Per 5 Minutes</label>
                                    <div class="input-with-currency">
                                        <span class="currency-symbol">$</span>
                                        <input type="number" class="form-control" id="waitTimeFee" value="5.00" step="0.01">
                                        <span class="currency-code">MXN</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Shopping Service Fee</label>
                                    <div class="input-with-percent">
                                        <input type="number" class="form-control" id="shoppingFeePercent" value="10" step="0.1">
                                        <span class="percent-symbol">% of purchase</span>
                                    </div>
                                </div>
                            </div>

                            <h4>City-Specific Pricing</h4>
                            <div class="city-pricing">
                                <div class="form-group">
                                    <label class="form-label">Select City</label>
                                    <select class="form-control" id="cityPricingSelect" onchange="loadCityPricing()">
                                        <option value="global">Global Settings</option>
                                        <option value="cdmx">Ciudad de México</option>
                                        <option value="guadalajara">Guadalajara</option>
                                        <option value="monterrey">Monterrey</option>
                                    </select>
                                </div>
                                <button class="btn btn--outline" onclick="copyCityPricing()">Copy from Global</button>
                            </div>

                            <div class="surge-pricing">
                                <h4>Surge Pricing Rules</h4>
                                <div class="surge-toggle">
                                    <label class="switch">
                                        <input type="checkbox" id="surgePricingEnabled" checked>
                                        <span class="slider"></span>
                                    </label>
                                    <span>Enable Surge Pricing</span>
                                </div>
                                
                                <div class="surge-rules" id="surgeRules">
                                    <div class="surge-rule">
                                        <span>Weekday Lunch (12:00-14:00):</span>
                                        <input type="number" class="form-control surge-input" value="1.3" step="0.1" min="1">×
                                    </div>
                                    <div class="surge-rule">
                                        <span>Weekday Evening (17:00-20:00):</span>
                                        <input type="number" class="form-control surge-input" value="1.5" step="0.1" min="1">×
                                    </div>
                                    <div class="surge-rule">
                                        <span>Weekends (All day):</span>
                                        <input type="number" class="form-control surge-input" value="1.2" step="0.1" min="1">×
                                    </div>
                                </div>
                            </div>

                            <div class="pricing-calculator-admin">
                                <h4>Live Pricing Calculator</h4>
                                <div class="calculator-inputs">
                                    <input type="number" placeholder="Stops" id="calcStops" min="1" max="5" value="3">
                                    <input type="number" placeholder="Distance (km)" id="calcDistance" step="0.1" value="12.5">
                                    <input type="number" placeholder="Wait time (min)" id="calcWaitTime" value="25">
                                    <input type="number" placeholder="Shopping amount" id="calcShoppingAmount" value="200">
                                    <button class="btn btn--primary" onclick="calculateTestPrice()">Calculate</button>
                                </div>
                                <div class="calculator-result" id="calculatorResult">Total: $296.63 MXN</div>
                            </div>

                            <button class="btn btn--primary btn--lg save-pricing-btn" onclick="savePricingSettings()">
                                <i class="fas fa-save"></i> Save All Settings
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Analytics Tab -->
                <div class="admin-tab-content" id="analyticsTab">
                    <div class="analytics-grid">
                        <div class="chart-card">
                            <h4>Popular Task Types</h4>
                            <canvas id="taskTypesChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <h4>Errands Over Time</h4>
                            <canvas id="errandsTimeChart"></canvas>
                        </div>
                        <div class="metrics-card">
                            <h4>Key Metrics</h4>
                            <div class="metric-item">
                                <span class="metric-label">Avg Completion Time:</span>
                                <span class="metric-value">42 min</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Photo Upload Rate:</span>
                                <span class="metric-value">98%</span>
                            </div>
                            <div class="metric-item">
                                <span class="metric-label">Most Popular Tasks:</span>
                                <span class="metric-value">Grocery, Flowers, Pharmacy</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Service Selection View -->
        <div class="view hidden" id="servicesView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('home')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Select Service</h2>
                    <div class="service-toggle">
                        <button class="toggle-btn active" id="ridesToggle" onclick="toggleServiceType('rides')">Rides</button>
                        <button class="toggle-btn" id="foodToggle" onclick="toggleServiceType('food')">Food</button>
                    </div>
                </div>

                <!-- Ride Services -->
                <div class="services-section" id="ridesSection">
                    <div class="services-grid" id="servicesGrid">
                        <!-- Services will be populated by JavaScript -->
                    </div>
                    
                    <!-- AI Route Example -->
                    <div class="ai-route-example">
                        <h3>Características Impulsadas por IA</h3>
                        <div class="route-card">
                            <div class="route-info">
                                <span class="route-path">Via Periférico • 18 min • 12.5 km</span>
                                <span class="confidence">Confianza: 92%</span>
                            </div>
                            <div class="ai-reasoning">
                                <small>IA optimized route avoiding peak traffic areas</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Food Delivery -->
                <div class="services-section hidden" id="foodSection">
                    <div class="food-categories">
                        <div class="category-card" onclick="showRestaurants('mexican')">
                            <i class="fas fa-pepper-hot"></i>
                            <span>Mexican</span>
                        </div>
                        <div class="category-card" onclick="showRestaurants('pizza')">
                            <i class="fas fa-pizza-slice"></i>
                            <span>Pizza</span>
                        </div>
                        <div class="category-card" onclick="showRestaurants('burgers')">
                            <i class="fas fa-hamburger"></i>
                            <span>Burgers</span>
                        </div>
                        <div class="category-card" onclick="showRestaurants('asian')">
                            <i class="fas fa-bowl-rice"></i>
                            <span>Asian</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet View -->
        <div class="view hidden" id="walletView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>My Wallet</h2>
                </div>

                <div class="wallet-content">
                    <div class="balance-card">
                        <div class="balance-amount">
                            <span class="currency">$</span>
                            <span class="amount" id="walletBalance">247.50</span>
                            <span class="currency-code">MXN</span>
                        </div>
                        <button class="btn btn--primary" onclick="showModal('addFundsModal')">Add Funds</button>
                    </div>

                    <div class="payment-methods">
                        <h3>Payment Methods</h3>
                        <div class="payment-method-list">
                            <div class="payment-method">
                                <i class="fas fa-credit-card"></i>
                                <span>Credit/Debit Card</span>
                                <i class="fas fa-check-circle text-success"></i>
                            </div>
                            <div class="payment-method">
                                <i class="fab fa-paypal"></i>
                                <span>PayPal</span>
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="payment-method">
                                <i class="fab fa-bitcoin"></i>
                                <span>Bitcoin (BTC)</span>
                                <span class="crypto-balance">0.0045 BTC</span>
                            </div>
                            <div class="payment-method">
                                <i class="fab fa-ethereum"></i>
                                <span>Ethereum (ETH)</span>
                                <span class="crypto-balance">0.12 ETH</span>
                            </div>
                        </div>
                    </div>

                    <div class="transaction-history">
                        <h3>Recent Transactions</h3>
                        <div class="transaction-list" id="transactionList">
                            <!-- Transactions will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Subscription View -->
        <div class="view hidden" id="subscriptionView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Subscription Plans</h2>
                </div>

                <div class="subscription-plans">
                    <div class="plan-card">
                        <div class="plan-header">
                            <h3>Basic</h3>
                            <div class="plan-price">Free</div>
                        </div>
                        <ul class="plan-features">
                            <li><i class="fas fa-check"></i> Standard ride booking</li>
                            <li><i class="fas fa-check"></i> Basic support</li>
                            <li><i class="fas fa-check"></i> Standard pricing</li>
                        </ul>
                        <button class="btn btn--outline current-plan">Current Plan</button>
                    </div>

                    <div class="plan-card featured">
                        <div class="plan-header">
                            <h3>Premium</h3>
                            <div class="plan-price">$9.99<span>/month</span></div>
                        </div>
                        <ul class="plan-features">
                            <li><i class="fas fa-check"></i> 5% discount on all rides</li>
                            <li><i class="fas fa-check"></i> Free food delivery fees</li>
                            <li><i class="fas fa-check"></i> Priority driver matching</li>
                            <li><i class="fas fa-check"></i> Zero cancellation fees</li>
                            <li><i class="fas fa-check"></i> 24/7 premium support</li>
                        </ul>
                        <button class="btn btn--primary" onclick="subscribe('premium')">Subscribe Now</button>
                    </div>

                    <div class="plan-card">
                        <div class="plan-header">
                            <h3>Driver</h3>
                            <div class="plan-price">$19.99<span>/month</span></div>
                        </div>
                        <ul class="plan-features">
                            <li><i class="fas fa-check"></i> Keep 100% of ride earnings</li>
                            <li><i class="fas fa-check"></i> Priority ride assignments</li>
                            <li><i class="fas fa-check"></i> Weekly instant payouts</li>
                            <li><i class="fas fa-check"></i> Lower platform fees</li>
                        </ul>
                        <button class="btn btn--primary" onclick="subscribe('driver')">Subscribe Now</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings View -->
        <div class="view hidden" id="settingsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Settings</h2>
                </div>

                <div class="settings-content">
                    <div class="setting-group">
                        <h3>Safety &amp; Security</h3>
                        <div class="setting-item">
                            <div class="setting-info">
                                <strong>Women-Only Rides</strong>
                                <p>Only match with verified female drivers</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="womenOnlyToggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-item">
                            <div class="setting-info">
                                <strong>Share Trip Status</strong>
                                <p>Automatically share ride details with emergency contacts</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="shareTripsToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Social Features</h3>
                        <div class="setting-item">
                            <div class="setting-info">
                                <strong>Meeting/Dating Module</strong>
                                <p class="warning-text">⚠️ Safety Notice: Always meet in public places, verify profiles, share location with friends.</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="datingToggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h3>Notifications</h3>
                        <div class="setting-item">
                            <div class="setting-info">
                                <strong>Push Notifications</strong>
                                <p>Receive alerts about ride status and promotions</p>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notificationsToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Driver Dashboard -->
        <div class="view hidden" id="driverDashboardView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('home')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Driver Dashboard</h2>
                    <div class="driver-status">
                        <label class="switch">
                            <input type="checkbox" id="driverOnlineToggle">
                            <span class="slider"></span>
                        </label>
                        <span id="driverStatusText">Offline</span>
                    </div>
                </div>

                <div class="driver-content">
                    <div class="earnings-summary">
                        <div class="earnings-card">
                            <div class="earnings-amount">$342.75</div>
                            <div class="earnings-label">Today's Earnings</div>
                        </div>
                        <div class="earnings-card">
                            <div class="earnings-amount">$1,247.50</div>
                            <div class="earnings-label">This Week</div>
                        </div>
                        <div class="earnings-card">
                            <div class="earnings-amount">23</div>
                            <div class="earnings-label">Trips Today</div>
                        </div>
                    </div>

                    <div class="service-toggles">
                        <h3>Active Services</h3>
                        <div class="service-toggle-grid">
                            <div class="service-toggle-item">
                                <label class="switch">
                                    <input type="checkbox" id="ridesServiceToggle" checked>
                                    <span class="slider"></span>
                                </label>
                                <span>Rides</span>
                            </div>
                            <div class="service-toggle-item">
                                <label class="switch">
                                    <input type="checkbox" id="foodServiceToggle">
                                    <span class="slider"></span>
                                </label>
                                <span>Food Delivery</span>
                            </div>
                        </div>
                    </div>

                    <div class="smart-routing" id="smartRoutingSection" style="display: none;">
                        <h3>Smart Routing Active</h3>
                        <div class="routing-info">
                            <p>You have an active food delivery. We'll show compatible ride requests along your route.</p>
                            <div class="route-details">
                                <div class="route-step">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>Pickup: Restaurant Plaza</span>
                                </div>
                                <div class="route-step">
                                    <i class="fas fa-flag"></i>
                                    <span>Delivery: Residencial Norte</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn--primary" onclick="showView('driverEarnings')">View Earnings</button>
                        <button class="btn btn--outline" onclick="instantPayout()">Instant Payout</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Assistant Modal -->
    <div class="modal" id="aiAssistantModal">
        <div class="modal-content ai-assistant-modal">
            <span class="close" onclick="closeModal('aiAssistantModal')">&times;</span>
            <h2><i class="fas fa-robot"></i> AIRide AI Assistant</h2>
            <div class="ai-chat-container">
                <div class="ai-chat-messages" id="aiChatMessages">
                    <div class="ai-message">
                        <div class="ai-avatar"><i class="fas fa-robot"></i></div>
                        <div class="message-content">
                            <p>Hello! I'm your AI assistant. I can help with platform analysis, decision support, health checks, and complex reasoning tasks. What would you like me to help with?</p>
                        </div>
                    </div>
                </div>
                <div class="ai-chat-input">
                    <input type="text" id="aiChatInput" placeholder="Ask me anything about your platform..." onkeypress="handleAIChatKeypress(event)">
                    <button class="btn btn--primary" onclick="sendAIMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            <div class="ai-reasoning-levels">
                <h4>AI Reasoning Levels Available:</h4>
                <div class="reasoning-grid">
                    <div class="reasoning-level">Level 1: Basic Logic</div>
                    <div class="reasoning-level">Level 2: Pattern Recognition</div>
                    <div class="reasoning-level">Level 3: Predictive Analysis</div>
                    <div class="reasoning-level">Level 4: Complex Planning</div>
                    <div class="reasoning-level">Level 5: Multi-Step Validation</div>
                    <div class="reasoning-level">Level 6: Strategic Reasoning</div>
                    <div class="reasoning-level">Level 7: Adaptive Learning</div>
                    <div class="reasoning-level">Level 8: Meta-Cognitive Analysis</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tokenization Dashboard Modal -->
    <div class="modal" id="tokenizationModal">
        <div class="modal-content tokenization-modal">
            <span class="close" onclick="closeModal('tokenizationModal')">&times;</span>
            <h2><i class="fas fa-coins"></i> Tokenization Dashboard</h2>
            <div class="token-tabs">
                <button class="tab-btn active" onclick="switchTokenTab('overview')">Overview</button>
                <button class="tab-btn" onclick="switchTokenTab('rewards')">Rewards</button>
                <button class="tab-btn" onclick="switchTokenTab('governance')">Governance</button>
                <button class="tab-btn" onclick="switchTokenTab('contracts')">Smart Contracts</button>
            </div>
            <div class="token-tab-content active" id="overviewTokenTab">
                <div class="token-stats">
                    <div class="token-stat-card">
                        <div class="stat-value">2.5M</div>
                        <div class="stat-label">RIDE Tokens Issued</div>
                    </div>
                    <div class="token-stat-card">
                        <div class="stat-value">$0.45</div>
                        <div class="stat-label">Current Token Price</div>
                    </div>
                    <div class="token-stat-card">
                        <div class="stat-value">85,432</div>
                        <div class="stat-label">Active Token Holders</div>
                    </div>
                    <div class="token-stat-card">
                        <div class="stat-value">$1.2M</div>
                        <div class="stat-label">Total Market Cap</div>
                    </div>
                </div>
                <div class="blockchain-status">
                    <h4>Blockchain Network Status</h4>
                    <div class="network-item">
                        <span>Ethereum (ERC-20)</span>
                        <span class="status-badge active">Live</span>
                    </div>
                    <div class="network-item">
                        <span>Solana (SPL)</span>
                        <span class="status-badge active">Live</span>
                    </div>
                    <div class="network-item">
                        <span>Polygon</span>
                        <span class="status-badge pending">Testing</span>
                    </div>
                </div>
            </div>
            <div class="token-tab-content" id="rewardsTokenTab">
                <div class="rewards-config">
                    <h4>Reward Configuration</h4>
                    <div class="form-group">
                        <label>Ride Completion Reward</label>
                        <input type="number" value="5" class="form-control"> RIDE tokens
                    </div>
                    <div class="form-group">
                        <label>Driver Incentive per Trip</label>
                        <input type="number" value="3" class="form-control"> RIDE tokens
                    </div>
                    <div class="form-group">
                        <label>Referral Bonus</label>
                        <input type="number" value="25" class="form-control"> RIDE tokens
                    </div>
                </div>
            </div>
            <div class="token-tab-content" id="governanceTokenTab">
                <div class="governance-proposals">
                    <h4>Active Proposals</h4>
                    <div class="proposal-item">
                        <h5>Increase Driver Commission Rate</h5>
                        <div class="proposal-votes">
                            <div class="vote-bar">
                                <div class="vote-for" style="width: 65%">For: 65%</div>
                                <div class="vote-against" style="width: 35%">Against: 35%</div>
                            </div>
                        </div>
                        <button class="btn btn--outline btn--sm">Vote</button>
                    </div>
                </div>
            </div>
            <div class="token-tab-content" id="contractsTokenTab">
                <div class="smart-contracts">
                    <h4>Smart Contract Status</h4>
                    <div class="contract-item">
                        <span>Reward Distribution</span>
                        <span class="status-badge active">Active</span>
                        <button class="btn btn--outline btn--sm">View on Etherscan</button>
                    </div>
                    <div class="contract-item">
                        <span>Governance Voting</span>
                        <span class="status-badge active">Active</span>
                        <button class="btn btn--outline btn--sm">View on Etherscan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
        <div class="view hidden" id="adminDashboardView">
            <div class="container">
                <div class="admin-header">
                    <h2>Admin Dashboard</h2>
                    <div class="admin-role" id="adminRole">Super Admin</div>
                </div>

                <div class="admin-content">
                    <div class="admin-stats">
                        <div class="admin-stat-card">
                            <div class="stat-value">12,543</div>
                            <div class="stat-label">Active Users</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="stat-value">2,847</div>
                            <div class="stat-label">Active Drivers</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="stat-value">156</div>
                            <div class="stat-label">Active Rides</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="stat-value">$47,329</div>
                            <div class="stat-label">Daily Revenue</div>
                        </div>
                    </div>

                    <div class="feature-toggles">
                        <h3>System Features</h3>
                        <div class="toggles-grid" id="featureTogglesGrid">
                            <!-- Feature toggles will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="admin-actions">
                        <button class="btn btn--primary" onclick="showModal('aiAssistantModal')"><i class="fas fa-robot"></i> AI Assistant</button>
                        <button class="btn btn--primary" onclick="showView('userManagement')">User Management</button>
                        <button class="btn btn--secondary" onclick="showView('driverApprovals')">Driver Approvals</button>
                        <button class="btn btn--outline" onclick="showView('supportTickets')">Support Tickets</button>
                        <button class="btn btn--outline" onclick="showModal('tokenizationModal')"><i class="fas fa-coins"></i> Tokenization</button>
                        <button class="btn btn--outline" onclick="showView('aiMonitoring')"><i class="fas fa-chart-line"></i> AI Monitoring</button>
                        <button class="btn btn--outline" onclick="showView('automationHub')"><i class="fas fa-cogs"></i> Automation Hub</button>
                        <button class="btn btn--outline" onclick="showView('whiteLabelSettings')">White Label Settings</button>
                        <button class="btn btn--outline" onclick="showView('liveEditor')"><i class="fas fa-edit"></i> Live Editor</button>
                        <button class="btn btn--outline" onclick="generateReport()">Generate Report</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- God Mode Map Dashboard -->
        <div class="view hidden" id="godModeMapView">
            <div class="god-mode-container">
                <div class="god-mode-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back to Admin
                    </button>
                    <h2>God Mode - Live Map Dashboard</h2>
                    <div class="god-mode-controls">
                        <select id="vehicleFilter" class="form-control" onchange="filterVehicles(this.value)">
                            <option value="all">All Vehicles</option>
                            <option value="available">Available Only</option>
                            <option value="on_ride">On Ride</option>
                            <option value="on_delivery">On Delivery</option>
                        </select>
                        <input type="text" id="vehicleSearch" class="form-control" placeholder="Search driver/plate" onkeyup="searchVehicles(this.value)">
                    </div>
                </div>
                <div class="god-mode-map-container" id="godModeMapContainer">
                    <div id="godModeMap"></div>
                    <div class="map-stats-overlay">
                        <div class="stat-box">
                            <div class="stat-value" id="totalVehicles">8,543</div>
                            <div class="stat-label">Active Vehicles</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="activeRides">2,847</div>
                            <div class="stat-label">Active Rides</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="activeDeliveries">3,295</div>
                            <div class="stat-label">Active Deliveries</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- User Management -->
        <div class="view hidden" id="userManagementView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>User Management</h2>
                    <div class="management-controls">
                        <input type="text" class="form-control" placeholder="Search users..." id="userSearch">
                        <select class="form-control" id="userFilter">
                            <option value="all">All Users</option>
                            <option value="active">Active</option>
                            <option value="suspended">Suspended</option>
                            <option value="premium">Premium</option>
                        </select>
                    </div>
                </div>
                <div class="management-table">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Plan</th>
                                <th>Trips</th>
                                <th>Rating</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            <!-- Users populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Driver Management -->
        <div class="view hidden" id="driverManagementView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Driver Management</h2>
                    <div class="management-controls">
                        <input type="text" class="form-control" placeholder="Search drivers..." id="driverSearch">
                        <select class="form-control" id="driverFilter">
                            <option value="all">All Drivers</option>
                            <option value="online">Online</option>
                            <option value="offline">Offline</option>
                            <option value="pending">Pending Approval</option>
                        </select>
                    </div>
                </div>
                <div class="management-table">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Driver ID</th>
                                <th>Name</th>
                                <th>Vehicle</th>
                                <th>Rating</th>
                                <th>Status</th>
                                <th>Earnings Today</th>
                                <th>Trips Today</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="driversTableBody">
                            <!-- Drivers populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Dispatch System -->
        <div class="view hidden" id="dispatchView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Dispatch System</h2>
                </div>
                <div class="dispatch-content">
                    <div class="dispatch-form">
                        <h3>Manual Dispatch</h3>
                        <form id="dispatchForm">
                            <div class="form-group">
                                <label class="form-label">Service Type</label>
                                <select class="form-control" id="dispatchService">
                                    <option value="taxi">Taxi</option>
                                    <option value="moto">Moto Taxi</option>
                                    <option value="colectivo">Colectivo</option>
                                    <option value="pickup">Pickup</option>
                                    <option value="food">Food Delivery</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Pickup Address</label>
                                <input type="text" class="form-control" id="dispatchPickup" placeholder="Enter pickup address">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Destination</label>
                                <input type="text" class="form-control" id="dispatchDestination" placeholder="Enter destination">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Assign Driver (Optional)</label>
                                <select class="form-control" id="assignDriver">
                                    <option value="">Auto-assign nearest</option>
                                    <option value="drv_001">Carlos M. - ABC-1234</option>
                                    <option value="drv_002">María G. - XYZ-5678</option>
                                    <option value="drv_003">Juan P. - DEF-9012</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn--primary btn--full-width">Dispatch Request</button>
                        </form>
                    </div>
                    <div class="messaging-center">
                        <h3>Messaging Center</h3>
                        <div class="message-form">
                            <div class="form-group">
                                <label class="form-label">Send To</label>
                                <select class="form-control" id="messageTarget">
                                    <option value="all">All Drivers</option>
                                    <option value="city">Drivers in Selected City</option>
                                    <option value="individual">Individual Driver</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Message</label>
                                <textarea class="form-control" id="messageText" placeholder="Enter your message..."></textarea>
                            </div>
                            <button class="btn btn--primary" onclick="sendMessage()">Send Message</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Settings -->
        <div class="view hidden" id="apiSettingsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>API &amp; Integration Settings</h2>
                </div>
                <div class="api-settings-content">
                    <div class="settings-section">
                        <h3>Maps API Configuration</h3>
                        <div class="api-form">
                            <div class="form-group">
                                <label class="form-label">Provider</label>
                                <select class="form-control" id="mapsProvider">
                                    <option value="google">Google Maps</option>
                                    <option value="mapbox">Mapbox</option>
                                    <option value="openstreetmap" selected>OpenStreetMap</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">API Key</label>
                                <input type="password" class="form-control" id="mapsApiKey" placeholder="Enter API key">
                            </div>
                            <button class="btn btn--outline" onclick="testConnection('maps')">Test Connection</button>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>Payment Gateway Settings</h3>
                        <div class="payment-tabs">
                            <button class="tab-btn active" onclick="switchPaymentTab('stripe')">Stripe</button>
                            <button class="tab-btn" onclick="switchPaymentTab('paypal')">PayPal</button>
                            <button class="tab-btn" onclick="switchPaymentTab('crypto')">Crypto</button>
                        </div>
                        
                        <div class="payment-tab-content active" id="stripeTab">
                            <div class="form-group">
                                <label class="form-label">Secret Key</label>
                                <input type="password" class="form-control" id="stripeSecretKey" placeholder="sk_live_...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Publishable Key</label>
                                <input type="text" class="form-control" id="stripePublishableKey" placeholder="pk_live_...">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Webhook URL</label>
                                <input type="text" class="form-control" id="stripeWebhookUrl" placeholder="https://yourapp.com/webhook">
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="stripeTestMode">
                                <span class="slider"></span>
                            </label>
                            <span>Test Mode</span>
                            <button class="btn btn--outline" onclick="testConnection('stripe')">Test Connection</button>
                        </div>
                        
                        <div class="payment-tab-content" id="paypalTab">
                            <div class="form-group">
                                <label class="form-label">Client ID</label>
                                <input type="text" class="form-control" id="paypalClientId" placeholder="Enter PayPal Client ID">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Secret Key</label>
                                <input type="password" class="form-control" id="paypalSecretKey" placeholder="Enter PayPal Secret">
                            </div>
                            <button class="btn btn--outline" onclick="testConnection('paypal')">Test Connection</button>
                        </div>
                        
                        <div class="payment-tab-content" id="cryptoTab">
                            <div class="form-group">
                                <label class="form-label">Blockchain Network</label>
                                <select class="form-control" id="blockchainNetwork">
                                    <option value="ethereum">Ethereum</option>
                                    <option value="solana">Solana</option>
                                    <option value="bitcoin">Bitcoin</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Platform Wallet Address</label>
                                <input type="text" class="form-control" id="platformWallet" placeholder="Enter wallet address">
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="autoConvertFiat">
                                <span class="slider"></span>
                            </label>
                            <span>Auto-convert to fiat</span>
                        </div>
                    </div>
                    
                    <div class="settings-section">
                        <h3>SMS/Notification API</h3>
                        <div class="api-form">
                            <div class="form-group">
                                <label class="form-label">Provider</label>
                                <select class="form-control" id="smsProvider">
                                    <option value="twilio">Twilio</option>
                                    <option value="firebase">Firebase</option>
                                    <option value="onesignal">OneSignal</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">API Key</label>
                                <input type="password" class="form-control" id="smsApiKey" placeholder="Enter API key">
                            </div>
                            <button class="btn btn--outline" onclick="testConnection('sms')">Test Connection</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- White Label Settings -->
        <div class="view hidden" id="whiteLabelSettingsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>White Label Configuration</h2>
                    <div class="setup-progress">
                        <span class="progress-text">Setup Progress: <strong>85%</strong></span>
                        <div class="progress-bar-header">
                            <div class="progress-fill-header" style="width: 85%"></div>
                        </div>
                    </div>
                </div>

                <div class="white-label-tabs">
                    <button class="tab-btn active" onclick="switchWhiteLabelTab('branding')">Branding &amp; Identity</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('regional')">Regional &amp; Localization</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('maps')">Maps &amp; Location</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('payments')">Payment Gateways</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('notifications')">SMS &amp; Notifications</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('integrations')">Integrations</button>
                    <button class="tab-btn" onclick="switchWhiteLabelTab('config')">Configuration</button>
                </div>

                <!-- Branding & App Identity Tab -->
                <div class="white-label-tab-content active" id="brandingTab">
                    <div class="config-section">
                        <h3>Application Identity</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Application Name</label>
                                    <input type="text" class="form-control" id="appName" value="AIRide" placeholder="e.g., MiRide, CityGo">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Company/Brand Name</label>
                                    <input type="text" class="form-control" id="companyName" placeholder="Your Company Name">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Tagline/Slogan</label>
                                    <input type="text" class="form-control" id="tagline" placeholder="Your mobility solution tagline">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">App Version</label>
                                    <input type="text" class="form-control" id="appVersion" value="1.0.0">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">iOS Bundle ID</label>
                                    <input type="text" class="form-control" id="iosBundleId" placeholder="com.yourcompany.appname">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Android Package Name</label>
                                    <input type="text" class="form-control" id="androidPackage" placeholder="com.yourcompany.appname">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Logo &amp; Assets</h3>
                        <div class="upload-grid">
                            <div class="upload-item">
                                <label class="upload-label">Light Mode Logo</label>
                                <div class="upload-area" onclick="triggerUpload('lightLogo')">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Upload PNG/SVG (Max 2MB)</span>
                                    <input type="file" id="lightLogo" accept="image/*" style="display:none">
                                </div>
                            </div>
                            <div class="upload-item">
                                <label class="upload-label">Dark Mode Logo</label>
                                <div class="upload-area" onclick="triggerUpload('darkLogo')">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Upload PNG/SVG (Max 2MB)</span>
                                    <input type="file" id="darkLogo" accept="image/*" style="display:none">
                                </div>
                            </div>
                            <div class="upload-item">
                                <label class="upload-label">App Icon iOS</label>
                                <div class="upload-area" onclick="triggerUpload('iosIcon')">
                                    <i class="fas fa-mobile-alt"></i>
                                    <span>1024x1024 PNG</span>
                                    <input type="file" id="iosIcon" accept="image/*" style="display:none">
                                </div>
                            </div>
                            <div class="upload-item">
                                <label class="upload-label">App Icon Android</label>
                                <div class="upload-area" onclick="triggerUpload('androidIcon')">
                                    <i class="fas fa-android"></i>
                                    <span>512x512 PNG</span>
                                    <input type="file" id="androidIcon" accept="image/*" style="display:none">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Color Scheme Customizer</h3>
                        <div class="color-customizer">
                            <div class="color-row">
                                <div class="color-field">
                                    <label class="form-label">Primary Brand Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="primaryColor" value="#1FB8CD">
                                        <input type="text" class="form-control color-hex" value="#1FB8CD">
                                    </div>
                                </div>
                                <div class="color-field">
                                    <label class="form-label">Secondary Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="secondaryColor" value="#5E5240">
                                        <input type="text" class="form-control color-hex" value="#5E5240">
                                    </div>
                                </div>
                                <div class="color-field">
                                    <label class="form-label">Accent Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="accentColor" value="#9333EA">
                                        <input type="text" class="form-control color-hex" value="#9333EA">
                                    </div>
                                </div>
                            </div>
                            <div class="color-row">
                                <div class="color-field">
                                    <label class="form-label">Success Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="successColor" value="#10B981">
                                        <input type="text" class="form-control color-hex" value="#10B981">
                                    </div>
                                </div>
                                <div class="color-field">
                                    <label class="form-label">Warning Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="warningColor" value="#F59E0B">
                                        <input type="text" class="form-control color-hex" value="#F59E0B">
                                    </div>
                                </div>
                                <div class="color-field">
                                    <label class="form-label">Error Color</label>
                                    <div class="color-input-wrapper">
                                        <input type="color" id="errorColor" value="#EF4444">
                                        <input type="text" class="form-control color-hex" value="#EF4444">
                                    </div>
                                </div>
                            </div>
                            <div class="palette-actions">
                                <button class="btn btn--outline" onclick="autoGeneratePalette()">Auto-Generate Palette</button>
                                <button class="btn btn--secondary" onclick="previewColors()">Preview Changes</button>
                                <button class="btn btn--primary" onclick="applyColors()">Apply Colors</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Regional & Localization Tab -->
                <div class="white-label-tab-content" id="regionalTab">
                    <div class="config-section">
                        <h3>Regional Settings</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Primary Country</label>
                                    <select class="form-control" id="primaryCountry">
                                        <option value="MX">Mexico</option>
                                        <option value="US">United States</option>
                                        <option value="CO">Colombia</option>
                                        <option value="ES">Spain</option>
                                        <option value="AR">Argentina</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Default Timezone</label>
                                    <select class="form-control" id="defaultTimezone">
                                        <option value="America/Mexico_City">Mexico City (GMT-6)</option>
                                        <option value="America/New_York">Eastern Time (GMT-5)</option>
                                        <option value="America/Los_Angeles">Pacific Time (GMT-8)</option>
                                        <option value="Europe/Madrid">Madrid (GMT+1)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Date Format</label>
                                    <select class="form-control" id="dateFormat">
                                        <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Time Format</label>
                                    <select class="form-control" id="timeFormat">
                                        <option value="24">24-hour (14:30)</option>
                                        <option value="12">12-hour (2:30 PM)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Language &amp; Localization</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Default Language</label>
                                    <select class="form-control" id="defaultLanguage">
                                        <option value="es-MX">Español (México)</option>
                                        <option value="en-US">English (US)</option>
                                        <option value="es-ES">Español (España)</option>
                                        <option value="pt-BR">Português (Brasil)</option>
                                        <option value="fr-FR">Français</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="autoDetectLanguage" checked>
                                        <span class="slider"></span>
                                        Auto-detect user language
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Supported Languages</label>
                                <div class="checkbox-grid">
                                    <label><input type="checkbox" checked> Español (México)</label>
                                    <label><input type="checkbox" checked> English (US)</label>
                                    <label><input type="checkbox"> Español (España)</label>
                                    <label><input type="checkbox"> Português (Brasil)</label>
                                    <label><input type="checkbox"> Français</label>
                                    <label><input type="checkbox"> Deutsch</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Currency Settings</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Default Currency</label>
                                    <select class="form-control" id="defaultCurrency">
                                        <option value="MXN">Mexican Peso (MXN)</option>
                                        <option value="USD">US Dollar (USD)</option>
                                        <option value="EUR">Euro (EUR)</option>
                                        <option value="GBP">British Pound (GBP)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Currency Position</label>
                                    <select class="form-control" id="currencyPosition">
                                        <option value="before">Before amount ($100)</option>
                                        <option value="after">After amount (100$)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableCrypto" checked>
                                        <span class="slider"></span>
                                        Enable Cryptocurrency Payments
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Additional Currencies</label>
                                    <div class="checkbox-grid">
                                        <label><input type="checkbox" checked> BTC</label>
                                        <label><input type="checkbox" checked> ETH</label>
                                        <label><input type="checkbox"> SOL</label>
                                        <label><input type="checkbox"> USDC</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Maps & Location Tab -->
                <div class="white-label-tab-content" id="mapsTab">
                    <div class="config-section">
                        <h3>Map Provider Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Map Provider</label>
                                    <select class="form-control" id="mapProvider">
                                        <option value="google">Google Maps</option>
                                        <option value="mapbox">Mapbox</option>
                                        <option value="openstreetmap" selected>OpenStreetMap (Free)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Map Style</label>
                                    <select class="form-control" id="mapStyle">
                                        <option value="standard">Standard</option>
                                        <option value="satellite">Satellite</option>
                                        <option value="dark">Dark Mode</option>
                                        <option value="terrain">Terrain</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section api-config">
                        <h3>Google Maps API</h3>
                        <div class="config-form">
                            <div class="form-group">
                                <label class="form-label">Google Maps API Key</label>
                                <div class="api-input-wrapper">
                                    <input type="password" class="form-control" id="googleMapsKey" placeholder="AIzaSy...">
                                    <button class="btn btn--outline test-btn" onclick="testConnection('googleMaps')">Test Connection</button>
                                </div>
                                <div class="connection-status" id="googleMapsStatus"></div>
                            </div>
                            <div class="form-group">
                                <label class="switch-label">
                                    <input type="checkbox" id="enablePlaces" checked>
                                    <span class="slider"></span>
                                    Enable Places Autocomplete
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="config-section api-config">
                        <h3>Mapbox Configuration</h3>
                        <div class="config-form">
                            <div class="form-group">
                                <label class="form-label">Mapbox Access Token</label>
                                <div class="api-input-wrapper">
                                    <input type="password" class="form-control" id="mapboxToken" placeholder="pk.ey...">
                                    <button class="btn btn--outline test-btn" onclick="testConnection('mapbox')">Test Connection</button>
                                </div>
                                <div class="connection-status" id="mapboxStatus"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payment Gateways Tab -->
                <div class="white-label-tab-content" id="paymentsTab">
                    <div class="config-section">
                        <h3>Stripe Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableStripe" checked>
                                        <span class="slider"></span>
                                        Enable Stripe
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Environment</label>
                                    <select class="form-control" id="stripeEnvironment">
                                        <option value="test">Test/Sandbox</option>
                                        <option value="live">Live/Production</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Publishable Key</label>
                                    <input type="text" class="form-control" id="stripePublishable" placeholder="pk_test_...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Secret Key</label>
                                    <input type="password" class="form-control" id="stripeSecret" placeholder="sk_test_...">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Webhook URL</label>
                                    <input type="url" class="form-control" id="stripeWebhook" placeholder="https://yourapp.com/webhook/stripe">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Webhook Secret</label>
                                    <input type="password" class="form-control" id="stripeWebhookSecret" placeholder="whsec_...">
                                </div>
                            </div>
                            <div class="form-group">
                                <button class="btn btn--outline" onclick="testConnection('stripe')">Test Stripe Connection</button>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>PayPal Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enablePayPal">
                                        <span class="slider"></span>
                                        Enable PayPal
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Environment</label>
                                    <select class="form-control" id="paypalEnvironment">
                                        <option value="sandbox">Sandbox</option>
                                        <option value="live">Live</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Client ID</label>
                                    <input type="text" class="form-control" id="paypalClientId" placeholder="AY...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Client Secret</label>
                                    <input type="password" class="form-control" id="paypalSecret" placeholder="EC...">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Cryptocurrency Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Crypto Processor</label>
                                    <select class="form-control" id="cryptoProcessor">
                                        <option value="coinbase">Coinbase Commerce</option>
                                        <option value="bitpay">BitPay</option>
                                        <option value="custom">Custom Wallet</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">API Key</label>
                                    <input type="password" class="form-control" id="cryptoApiKey" placeholder="Enter API key">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Accepted Cryptocurrencies</label>
                                <div class="checkbox-grid">
                                    <label><input type="checkbox" checked> Bitcoin (BTC)</label>
                                    <label><input type="checkbox" checked> Ethereum (ETH)</label>
                                    <label><input type="checkbox" checked> Solana (SOL)</label>
                                    <label><input type="checkbox"> USDC</label>
                                    <label><input type="checkbox"> Litecoin (LTC)</label>
                                    <label><input type="checkbox"> Dogecoin (DOGE)</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SMS & Notifications Tab -->
                <div class="white-label-tab-content" id="notificationsTab">
                    <div class="config-section">
                        <h3>SMS Provider Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">SMS Provider</label>
                                    <select class="form-control" id="smsProvider">
                                        <option value="twilio">Twilio</option>
                                        <option value="firebase">Firebase Cloud Messaging</option>
                                        <option value="aws">AWS SNS</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Account SID / Project ID</label>
                                    <input type="text" class="form-control" id="smsAccountId" placeholder="AC...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Auth Token / API Key</label>
                                    <input type="password" class="form-control" id="smsAuthToken" placeholder="Auth token">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">From Phone Number</label>
                                <input type="tel" class="form-control" id="smsFromNumber" placeholder="+1234567890">
                            </div>
                            <button class="btn btn--outline" onclick="testSMS()">Send Test SMS</button>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Email Service Configuration</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Email Provider</label>
                                    <select class="form-control" id="emailProvider">
                                        <option value="sendgrid">SendGrid</option>
                                        <option value="aws-ses">AWS SES</option>
                                        <option value="mailgun">Mailgun</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">API Key</label>
                                    <input type="password" class="form-control" id="emailApiKey" placeholder="SG...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">From Email</label>
                                    <input type="email" class="form-control" id="fromEmail" placeholder="noreply@yourapp.com">
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label">From Name</label>
                                <input type="text" class="form-control" id="fromName" placeholder="Your App Name">
                            </div>
                            <button class="btn btn--outline" onclick="testEmail()">Send Test Email</button>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Push Notifications</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableOneSignal" checked>
                                        <span class="slider"></span>
                                        Enable OneSignal Push Notifications
                                    </label>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">OneSignal App ID</label>
                                    <input type="text" class="form-control" id="oneSignalAppId" placeholder="12345678-1234-1234-1234-123456789012">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">REST API Key</label>
                                    <input type="password" class="form-control" id="oneSignalApiKey" placeholder="YW...">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Integrations Tab -->
                <div class="white-label-tab-content" id="integrationsTab">
                    <div class="config-section">
                        <h3>Analytics &amp; Tracking</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableGA4" checked>
                                        <span class="slider"></span>
                                        Enable Google Analytics 4
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">GA4 Measurement ID</label>
                                    <input type="text" class="form-control" id="ga4MeasurementId" placeholder="G-XXXXXXXXXX">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableMixpanel">
                                        <span class="slider"></span>
                                        Enable Mixpanel
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Mixpanel Project Token</label>
                                    <input type="text" class="form-control" id="mixpanelToken" placeholder="abc123...">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Social Login Integration</h3>
                        <div class="config-form">
                            <div class="social-login-grid">
                                <div class="social-login-item">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableFacebook">
                                        <span class="slider"></span>
                                        Facebook Login
                                    </label>
                                    <input type="text" class="form-control" id="facebookAppId" placeholder="Facebook App ID">
                                    <input type="password" class="form-control" id="facebookSecret" placeholder="App Secret">
                                </div>
                                <div class="social-login-item">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableGoogle">
                                        <span class="slider"></span>
                                        Google Sign-In
                                    </label>
                                    <input type="text" class="form-control" id="googleClientId" placeholder="Google Client ID">
                                    <input type="password" class="form-control" id="googleClientSecret" placeholder="Client Secret">
                                </div>
                                <div class="social-login-item">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableApple">
                                        <span class="slider"></span>
                                        Apple Sign-In
                                    </label>
                                    <input type="text" class="form-control" id="appleServiceId" placeholder="Service ID">
                                    <input type="text" class="form-control" id="appleTeamId" placeholder="Team ID">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Cloud Storage &amp; CDN</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Storage Provider</label>
                                    <select class="form-control" id="storageProvider">
                                        <option value="aws-s3">AWS S3</option>
                                        <option value="google-cloud">Google Cloud Storage</option>
                                        <option value="azure">Azure Blob Storage</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Access Key ID</label>
                                    <input type="text" class="form-control" id="storageAccessKey" placeholder="AKIA...">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Secret Access Key</label>
                                    <input type="password" class="form-control" id="storageSecretKey" placeholder="Secret key">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Bucket/Container Name</label>
                                    <input type="text" class="form-control" id="storageBucket" placeholder="your-app-bucket">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Region</label>
                                    <select class="form-control" id="storageRegion">
                                        <option value="us-east-1">US East (N. Virginia)</option>
                                        <option value="us-west-2">US West (Oregon)</option>
                                        <option value="eu-west-1">Europe (Ireland)</option>
                                    </select>
                                </div>
                            </div>
                            <button class="btn btn--outline" onclick="testConnection('storage')">Test Connection</button>
                        </div>
                    </div>
                </div>

                <!-- Configuration Management Tab -->
                <div class="white-label-tab-content" id="configTab">
                    <div class="config-section">
                        <h3>Legal &amp; Compliance</h3>
                        <div class="config-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Terms of Service URL</label>
                                    <input type="url" class="form-control" id="termsUrl" placeholder="https://yourapp.com/terms">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Privacy Policy URL</label>
                                    <input type="url" class="form-control" id="privacyUrl" placeholder="https://yourapp.com/privacy">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Support Email</label>
                                    <input type="email" class="form-control" id="supportEmail" placeholder="support@yourapp.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Support Phone</label>
                                    <input type="tel" class="form-control" id="supportPhone" placeholder="+1-800-XXX-XXXX">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="switch-label">
                                        <input type="checkbox" id="enableGDPR">
                                        <span class="slider"></span>
                                        GDPR Compliance (EU)
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Minimum Age Requirement</label>
                                    <select class="form-control" id="minAge">
                                        <option value="13">13 years</option>
                                        <option value="16">16 years</option>
                                        <option value="18">18 years</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Configuration Templates</h3>
                        <div class="template-selector">
                            <div class="template-grid">
                                <div class="template-card" onclick="loadTemplate('mexico')">
                                    <div class="template-icon">
                                        <i class="fas fa-flag"></i>
                                    </div>
                                    <h4>Mexico Template</h4>
                                    <p>Pre-configured for Mexico market with OXXO, SPEI, MXN currency</p>
                                </div>
                                <div class="template-card" onclick="loadTemplate('usa')">
                                    <div class="template-icon">
                                        <i class="fas fa-star-and-crescent"></i>
                                    </div>
                                    <h4>USA Template</h4>
                                    <p>Optimized for US market with Stripe, PayPal, USD currency</p>
                                </div>
                                <div class="template-card" onclick="loadTemplate('spain')">
                                    <div class="template-icon">
                                        <i class="fas fa-sun"></i>
                                    </div>
                                    <h4>Spain Template</h4>
                                    <p>EU-compliant setup with GDPR, EUR currency, Spanish language</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Export/Import Configuration</h3>
                        <div class="config-management">
                            <div class="config-actions">
                                <button class="btn btn--primary" onclick="exportConfiguration()">
                                    <i class="fas fa-download"></i>
                                    Export All Settings
                                </button>
                                <button class="btn btn--outline" onclick="importConfiguration()">
                                    <i class="fas fa-upload"></i>
                                    Import Configuration
                                </button>
                                <button class="btn btn--secondary" onclick="cloneInstance()">
                                    <i class="fas fa-copy"></i>
                                    Clone to New Instance
                                </button>
                                <button class="btn btn--outline" onclick="resetToDefaults()">
                                    <i class="fas fa-undo"></i>
                                    Reset to Defaults
                                </button>
                            </div>
                            <input type="file" id="configFileInput" accept=".json" style="display: none">
                        </div>
                    </div>

                    <div class="config-section">
                        <h3>Setup Checklist</h3>
                        <div class="setup-checklist">
                            <div class="checklist-item completed">
                                <i class="fas fa-check-circle"></i>
                                <span>Branding configured</span>
                            </div>
                            <div class="checklist-item completed">
                                <i class="fas fa-check-circle"></i>
                                <span>Colors customized</span>
                            </div>
                            <div class="checklist-item completed">
                                <i class="fas fa-check-circle"></i>
                                <span>Maps API connected</span>
                            </div>
                            <div class="checklist-item pending">
                                <i class="fas fa-exclamation-circle"></i>
                                <span>Payment gateway pending</span>
                            </div>
                            <div class="checklist-item pending">
                                <i class="fas fa-exclamation-circle"></i>
                                <span>SMS service pending</span>
                            </div>
                            <div class="checklist-item completed">
                                <i class="fas fa-check-circle"></i>
                                <span>Database connected</span>
                            </div>
                            <div class="checklist-item completed">
                                <i class="fas fa-check-circle"></i>
                                <span>Storage configured</span>
                            </div>
                            <div class="checklist-item">
                                <i class="fas fa-circle"></i>
                                <span>Legal pages linked</span>
                            </div>
                            <div class="checklist-item">
                                <i class="fas fa-circle"></i>
                                <span>Test ride completed</span>
                            </div>
                        </div>
                        <button class="btn btn--primary btn--lg" onclick="continueSetup()">Continue Setup</button>
                    </div>
                </div>

                <!-- Save All Button -->
                <div class="white-label-footer">
                    <button class="btn btn--primary btn--lg" onclick="saveWhiteLabelSettings()">
                        <i class="fas fa-save"></i>
                        Save All White Label Settings
                    </button>
                    <button class="btn btn--outline" onclick="previewApp()">
                        <i class="fas fa-eye"></i>
                        Preview App
                    </button>
                    <button class="btn btn--secondary" onclick="deployApp()">
                        <i class="fas fa-rocket"></i>
                        Deploy to Production
                    </button>
                </div>
            </div>
        </div>

        <!-- AI Monitoring Dashboard -->
        <div class="view hidden" id="aiMonitoringView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>AI Monitoring &amp; Continuous Validation</h2>
                    <div class="monitoring-status">
                        <span class="status-badge active">AI Active</span>
                        <span class="health-score">Health: 98.7%</span>
                    </div>
                </div>
                
                <div class="monitoring-dashboard">
                    <div class="monitoring-section">
                        <h3>Real-Time System Health</h3>
                        <div class="health-metrics">
                            <div class="metric-card">
                                <div class="metric-icon"><i class="fas fa-heartbeat"></i></div>
                                <div class="metric-data">
                                    <div class="metric-value">98.7%</div>
                                    <div class="metric-label">Overall Health</div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-icon"><i class="fas fa-shield-alt"></i></div>
                                <div class="metric-data">
                                    <div class="metric-value">99.2%</div>
                                    <div class="metric-label">Security Score</div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-icon"><i class="fas fa-tachometer-alt"></i></div>
                                <div class="metric-data">
                                    <div class="metric-value">0.2ms</div>
                                    <div class="metric-label">Response Time</div>
                                </div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-icon"><i class="fas fa-robot"></i></div>
                                <div class="metric-data">
                                    <div class="metric-value">Level 8</div>
                                    <div class="metric-label">AI Reasoning</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="monitoring-section">
                        <h3>8-Level Validation Tests</h3>
                        <div class="validation-levels">
                            <div class="validation-level passed">
                                <span class="level-number">1</span>
                                <span class="level-name">Basic Logic Validation</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">2</span>
                                <span class="level-name">Pattern Recognition</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">3</span>
                                <span class="level-name">Predictive Analysis</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">4</span>
                                <span class="level-name">Complex Planning</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">5</span>
                                <span class="level-name">Multi-Step Validation</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">6</span>
                                <span class="level-name">Strategic Reasoning</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                            <div class="validation-level warning">
                                <span class="level-number">7</span>
                                <span class="level-name">Adaptive Learning</span>
                                <span class="level-status"><i class="fas fa-exclamation-triangle"></i> Warning</span>
                            </div>
                            <div class="validation-level passed">
                                <span class="level-number">8</span>
                                <span class="level-name">Meta-Cognitive Analysis</span>
                                <span class="level-status"><i class="fas fa-check"></i> Passed</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="monitoring-section">
                        <h3>AI Actions Log</h3>
                        <div class="ai-actions-log">
                            <div class="log-item">
                                <span class="log-time">14:32:15</span>
                                <span class="log-action">Auto-assigned driver to ride #RD-8374</span>
                                <span class="log-reasoning">Level 4 reasoning - optimal route match</span>
                                <button class="btn btn--sm btn--outline">View Details</button>
                            </div>
                            <div class="log-item">
                                <span class="log-time">14:28:42</span>
                                <span class="log-action">Escalated payment issue #PY-2847</span>
                                <span class="log-reasoning">Level 3 pattern detection - fraud risk</span>
                                <button class="btn btn--sm btn--outline">View Details</button>
                            </div>
                            <div class="log-item">
                                <span class="log-time">14:25:18</span>
                                <span class="log-action">Optimized route for driver #DRV-445</span>
                                <span class="log-reasoning">Level 5 multi-step validation - traffic analysis</span>
                                <button class="btn btn--sm btn--outline">View Details</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Automation Hub -->
        <div class="view hidden" id="automationHubView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Automation Hub</h2>
                    <div class="automation-controls">
                        <button class="btn btn--primary" onclick="createAutomation()"><i class="fas fa-plus"></i> New Automation</button>
                        <button class="btn btn--outline" onclick="runDiagnostics()"><i class="fas fa-stethoscope"></i> Run Diagnostics</button>
                    </div>
                </div>
                
                <div class="automation-dashboard">
                    <div class="automation-stats">
                        <div class="stat-card">
                            <div class="stat-value">47</div>
                            <div class="stat-label">Active Automations</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">2,847</div>
                            <div class="stat-label">Tasks Automated Today</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">99.2%</div>
                            <div class="stat-label">Success Rate</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">34.5h</div>
                            <div class="stat-label">Time Saved Today</div>
                        </div>
                    </div>
                    
                    <div class="automation-section">
                        <h3>Active Automation Rules</h3>
                        <div class="automation-list">
                            <div class="automation-item">
                                <div class="automation-info">
                                    <h4>Driver Auto-Assignment</h4>
                                    <p>Automatically assigns nearest available driver when ride is requested</p>
                                    <div class="automation-triggers">
                                        <span class="trigger-tag">Trigger: New Ride Request</span>
                                        <span class="action-tag">Action: Assign Driver</span>
                                    </div>
                                </div>
                                <div class="automation-controls">
                                    <span class="status-badge active">Active</span>
                                    <button class="btn btn--sm btn--outline">Edit</button>
                                    <button class="btn btn--sm btn--secondary">Pause</button>
                                </div>
                            </div>
                            <div class="automation-item">
                                <div class="automation-info">
                                    <h4>Task Escalation</h4>
                                    <p>Escalates tasks to admin if no action taken within 30 minutes</p>
                                    <div class="automation-triggers">
                                        <span class="trigger-tag">Trigger: Task Timeout</span>
                                        <span class="action-tag">Action: Escalate</span>
                                    </div>
                                </div>
                                <div class="automation-controls">
                                    <span class="status-badge active">Active</span>
                                    <button class="btn btn--sm btn--outline">Edit</button>
                                    <button class="btn btn--sm btn--secondary">Pause</button>
                                </div>
                            </div>
                            <div class="automation-item">
                                <div class="automation-info">
                                    <h4>Anomaly Detection</h4>
                                    <p>Monitors for unusual patterns and sends alerts to admin</p>
                                    <div class="automation-triggers">
                                        <span class="trigger-tag">Trigger: Pattern Detected</span>
                                        <span class="action-tag">Action: Send Alert</span>
                                    </div>
                                </div>
                                <div class="automation-controls">
                                    <span class="status-badge active">Active</span>
                                    <button class="btn btn--sm btn--outline">Edit</button>
                                    <button class="btn btn--sm btn--secondary">Pause</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="automation-section">
                        <h3>Self-Healing Actions</h3>
                        <div class="self-healing-rules">
                            <div class="healing-rule">
                                <span class="rule-name">Database Connection Recovery</span>
                                <span class="rule-status active">Active</span>
                                <span class="rule-triggers">Last triggered: 2 hours ago</span>
                            </div>
                            <div class="healing-rule">
                                <span class="rule-name">Payment Gateway Failover</span>
                                <span class="rule-status active">Active</span>
                                <span class="rule-triggers">Last triggered: Never</span>
                            </div>
                            <div class="healing-rule">
                                <span class="rule-name">Load Balancer Auto-Scale</span>
                                <span class="rule-status active">Active</span>
                                <span class="rule-triggers">Last triggered: 4 hours ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Live Editor -->
        <div class="view hidden" id="liveEditorView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Live Editor - Cursor AI Powered</h2>
                    <div class="editor-controls">
                        <button class="btn btn--primary" onclick="enableEditMode()"><i class="fas fa-edit"></i> Enable Edit Mode</button>
                        <button class="btn btn--outline" onclick="previewChanges()"><i class="fas fa-eye"></i> Preview</button>
                        <button class="btn btn--success" onclick="saveChanges()"><i class="fas fa-save"></i> Save</button>
                        <button class="btn btn--warning" onclick="rollbackChanges()"><i class="fas fa-undo"></i> Rollback</button>
                    </div>
                </div>
                
                <div class="live-editor-dashboard">
                    <div class="editor-tabs">
                        <button class="tab-btn active" onclick="switchEditorTab('visual')">Visual Editor</button>
                        <button class="tab-btn" onclick="switchEditorTab('code')">Code Editor</button>
                        <button class="tab-btn" onclick="switchEditorTab('ai')">AI Assistant</button>
                    </div>
                    
                    <div class="editor-tab-content active" id="visualEditorTab">
                        <div class="visual-editor">
                            <div class="editor-sidebar">
                                <h4>Components</h4>
                                <div class="component-list">
                                    <div class="component-item" draggable="true">Button</div>
                                    <div class="component-item" draggable="true">Text</div>
                                    <div class="component-item" draggable="true">Image</div>
                                    <div class="component-item" draggable="true">Form</div>
                                    <div class="component-item" draggable="true">Card</div>
                                </div>
                                <h4>Properties</h4>
                                <div class="properties-panel">
                                    <div class="form-group">
                                        <label>Text Color</label>
                                        <input type="color" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>Background</label>
                                        <input type="color" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>Font Size</label>
                                        <select class="form-control">
                                            <option>Small</option>
                                            <option>Medium</option>
                                            <option>Large</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="editor-canvas">
                                <div class="canvas-header">
                                    <span>Live Preview</span>
                                    <button class="btn btn--sm btn--outline">Mobile View</button>
                                </div>
                                <div class="canvas-content">
                                    <p>Drag components here to start editing</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="editor-tab-content" id="codeEditorTab">
                        <div class="code-editor">
                            <div class="code-editor-toolbar">
                                <select class="form-control">
                                    <option>index.html</option>
                                    <option>style.css</option>
                                    <option>app.js</option>
                                </select>
                                <button class="btn btn--sm btn--outline">Format Code</button>
                                <button class="btn btn--sm btn--outline">Lint</button>
                            </div>
                            <textarea class="code-textarea" placeholder="// Code editor - AI-powered with syntax highlighting and suggestions">
&lt;div class="service-card"&gt;
  &lt;div class="service-icon"&gt;
    &lt;i class="fas fa-car"&gt;&lt;/i&gt;
  &lt;/div&gt;
  &lt;div class="service-name"&gt;TAXI&lt;/div&gt;
&lt;/div&gt;
                            </textarea>
                        </div>
                    </div>
                    
                    <div class="editor-tab-content" id="aiEditorTab">
                        <div class="ai-editor-assistant">
                            <div class="ai-suggestions">
                                <h4>AI Suggestions</h4>
                                <div class="suggestion-item">
                                    <p>Add a new service type for helicopter rides</p>
                                    <button class="btn btn--sm btn--primary">Apply</button>
                                </div>
                                <div class="suggestion-item">
                                    <p>Optimize button layout for mobile devices</p>
                                    <button class="btn btn--sm btn--primary">Apply</button>
                                </div>
                                <div class="suggestion-item">
                                    <p>Add dark mode toggle functionality</p>
                                    <button class="btn btn--sm btn--primary">Apply</button>
                                </div>
                            </div>
                            <div class="ai-chat">
                                <h4>Chat with AI</h4>
                                <div class="ai-chat-messages">
                                    <div class="ai-message">
                                        <p>How can I help you modify the app today?</p>
                                    </div>
                                </div>
                                <div class="ai-chat-input">
                                    <input type="text" placeholder="Ask me to make changes...">
                                    <button class="btn btn--primary">Send</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Support Tickets -->
        <div class="view hidden" id="supportTicketsView">
            <div class="container">
                <div class="view-header">
                    <button class="btn btn--secondary" onclick="showView('adminDashboard')">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <h2>Support Tickets</h2>
                    <div class="ticket-controls">
                        <select class="form-control" id="ticketFilter">
                            <option value="all">All Tickets</option>
                            <option value="open">Open</option>
                            <option value="in_progress">In Progress</option>
                            <option value="resolved">Resolved</option>
                        </select>
                        <select class="form-control" id="priorityFilter">
                            <option value="all">All Priorities</option>
                            <option value="high">High</option>
                            <option value="medium">Medium</option>
                            <option value="low">Low</option>
                        </select>
                    </div>
                </div>
                <div class="tickets-list">
                    <div class="ticket-item">
                        <div class="ticket-header">
                            <div class="ticket-id">#TK-001</div>
                            <div class="ticket-priority high">High</div>
                            <div class="ticket-status open">Open</div>
                        </div>
                        <div class="ticket-content">
                            <h4>Payment Issue - Card Declined</h4>
                            <p>User reports payment card being declined during ride booking.</p>
                            <div class="ticket-meta">
                                <span>User: john.doe@email.com</span>
                                <span>Created: 2 hours ago</span>
                                <span>Agent: Unassigned</span>
                            </div>
                        </div>
                        <div class="ticket-actions">
                            <button class="btn btn--sm btn--outline" onclick="assignTicket('TK-001')">Assign to Me</button>
                            <button class="btn btn--sm btn--primary" onclick="viewTicket('TK-001')">View Details</button>
                        </div>
                    </div>
                    
                    <div class="ticket-item">
                        <div class="ticket-header">
                            <div class="ticket-id">#TK-002</div>
                            <div class="ticket-priority medium">Medium</div>
                            <div class="ticket-status in_progress">In Progress</div>
                        </div>
                        <div class="ticket-content">
                            <h4>Driver Rating Dispute</h4>
                            <p>Driver requesting review of unfair rating from passenger.</p>
                            <div class="ticket-meta">
                                <span>Driver: carlos.martinez@email.com</span>
                                <span>Created: 6 hours ago</span>
                                <span>Agent: Sarah Johnson</span>
                            </div>
                        </div>
                        <div class="ticket-actions">
                            <button class="btn btn--sm btn--outline" onclick="escalateTicket('TK-002')">Escalate</button>
                            <button class="btn btn--sm btn--primary" onclick="viewTicket('TK-002')">View Details</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Funds Modal -->
    <div class="modal" id="addFundsModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addFundsModal')">&times;</span>
            <h2>Add Funds</h2>
            <form id="addFundsForm">
                <div class="form-group">
                    <label class="form-label">Amount (MXN)</label>
                    <input type="number" class="form-control" id="fundAmount" min="10" max="5000" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Payment Method</label>
                    <select class="form-control" id="paymentMethod">
                        <option value="card">Credit/Debit Card</option>
                        <option value="paypal">PayPal</option>
                        <option value="btc">Bitcoin</option>
                        <option value="eth">Ethereum</option>
                    </select>
                </div>
                <button type="submit" class="btn btn--primary btn--full-width">Add Funds</button>
            </form>
        </div>
    </div>

    <!-- Emergency SOS Button -->
    <button class="sos-button hidden" id="sosButton" onclick="triggerSOS()">
        <i class="fas fa-exclamation-triangle"></i>
        SOS
    </button>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="app.js"></script>
</body>
</html>